# ä»Šæ—¥è®¡åˆ’çœ‹æ¿å“åº”æ ¼å¼ä¿®å¤

## é—®é¢˜æè¿°

```
âŒ [ä»Šæ—¥è®¡åˆ’çœ‹æ¿] åŠ è½½ç»Ÿè®¡æ•°æ®å¤±è´¥: 
TypeError: Cannot read properties of undefined (reading 'total')
```

## é—®é¢˜åŸå› 

åç«¯APIè¿”å›çš„æ•°æ®æ˜¯**åµŒå¥—ç»“æ„**ï¼š

```javascript
{
  code: "0",
  msg: "æˆåŠŸ",
  data: {
    code: "0",
    msg: "æˆåŠŸ",
    data: {  // â† çœŸæ­£çš„æ•°æ®åœ¨è¿™é‡Œï¼
      visitorStats: {
        total: 326,
        completed: 12,
        pending: 314,
        percentage: "3.7"
      },
      vehicleStats: {
        expected: 306,
        arrived: 9,
        current: 297
      }
    }
  }
}
```

å‰ç«¯ä»£ç æœŸæœ› `response.data.data.visitorStats`ï¼Œä½†å®é™…åº”è¯¥æ˜¯ `response.data.data.data.visitorStats`ã€‚

## ä¿®å¤æ–¹æ¡ˆ

ä¿®æ”¹å‰ç«¯è§£æé€»è¾‘ï¼Œ**å…¼å®¹ä¸¤ç§æ ¼å¼**ï¼š

### ä¿®æ”¹ä½ç½®1ï¼šloadStatistics æ–¹æ³•

```javascript
// ä¿®æ”¹å‰ï¼šç›´æ¥è®¿é—® response.data.data
const data = response.data.data;

// ä¿®æ”¹åï¼šæ™ºèƒ½æ£€æµ‹åµŒå¥—å±‚çº§
let data = null;

if (response.data) {
  // åµŒå¥—ç»“æ„
  if (response.data.code === '0' && response.data.data && response.data.data.data) {
    data = response.data.data.data;
    console.log('âœ… æ£€æµ‹åˆ°åµŒå¥—ç»“æ„');
  }
  // ç®€å•ç»“æ„
  else if (response.data.code === '0' && response.data.data) {
    data = response.data.data;
    console.log('âœ… æ£€æµ‹åˆ°ç®€å•ç»“æ„');
  }
}

if (data && data.visitorStats && data.vehicleStats) {
  // ä½¿ç”¨æ•°æ®...
}
```

### ä¿®æ”¹ä½ç½®2ï¼šshowDetailModal æ–¹æ³•

åŒæ ·çš„ä¿®å¤åº”ç”¨åˆ°è¯¦æƒ…åˆ—è¡¨APIã€‚

## ä¿®å¤ç»“æœ

### ä¿®å¤å‰

```
âŒ TypeError: Cannot read properties of undefined (reading 'total')
```

### ä¿®å¤å

```
âœ… [ä»Šæ—¥è®¡åˆ’çœ‹æ¿] æ£€æµ‹åˆ°åµŒå¥—ç»“æ„ï¼Œä½¿ç”¨ response.data.data.data
âœ… [ä»Šæ—¥è®¡åˆ’çœ‹æ¿] æ•°æ®åŠ è½½æˆåŠŸ {è®¿å®¢: "12/326", è½¦è¾†: "9/306"}
```

## æµ‹è¯•æ­¥éª¤

### 1. åˆ·æ–°å‰ç«¯é¡µé¢

æŒ‰ `Ctrl + F5` å¼ºåˆ¶åˆ·æ–°æµè§ˆå™¨ã€‚

### 2. æŸ¥çœ‹æ§åˆ¶å°æ—¥å¿—

åº”è¯¥çœ‹åˆ°ï¼š
```
ğŸ“Š [ä»Šæ—¥è®¡åˆ’çœ‹æ¿] å¼€å§‹åŠ è½½ç»Ÿè®¡æ•°æ®...
ğŸ“¡ [ä»Šæ—¥è®¡åˆ’çœ‹æ¿] APIå“åº”: {code: "0", ...}
âœ… [ä»Šæ—¥è®¡åˆ’çœ‹æ¿] æ£€æµ‹åˆ°åµŒå¥—ç»“æ„
âœ… [ä»Šæ—¥è®¡åˆ’çœ‹æ¿] æ•°æ®åŠ è½½æˆåŠŸ {è®¿å®¢: "12/326", è½¦è¾†: "9/306"}
```

### 3. éªŒè¯æ°´æ³¢å›¾

- **å·¦ä¾§**ï¼š"è®¡åˆ’è®¿å®¢ 326 äºº"ï¼Œæ°´æ³¢å›¾å¡«å…… 3.7%ï¼ˆ12/326ï¼‰
- **å³ä¾§**ï¼š"é¢„è®¡è½¦è¾† 306 è¾†"ï¼Œæ°´æ³¢å›¾å¡«å…… 2.9%ï¼ˆ9/306ï¼‰

### 4. æµ‹è¯•è¯¦æƒ…å¼¹çª—

- ç‚¹å‡»å·¦ä¾§æ°´æ³¢å›¾ â†’ æ˜¾ç¤º326æ¡è®¿å®¢è®°å½•
- ç‚¹å‡»å³ä¾§æ°´æ³¢å›¾ â†’ æ˜¾ç¤º306æ¡è½¦è¾†è®°å½•

## ç›¸å…³é—®é¢˜

è¿™ä¸ªé—®é¢˜å’Œä¹‹å‰çš„**äººè„¸æ•°æ®API**é‡åˆ°çš„é—®é¢˜å®Œå…¨ä¸€æ ·ï¼š

- äººè„¸æ•°æ®APIï¼š`/parking/analysis/face/channel-statistics`
- ä»Šæ—¥è®¡åˆ’APIï¼š`/parking/visitor/plan-dashboard/statistics`

éƒ½æ˜¯åç«¯è¿”å›äº†åµŒå¥—çš„ `{code, data: {code, data: {...}}}` ç»“æ„ã€‚

## æ ¹æœ¬åŸå› 

å¯èƒ½æ˜¯åç«¯ä½¿ç”¨äº†ç»Ÿä¸€çš„å“åº”åŒ…è£…å™¨ï¼ˆResponse Wrapperï¼‰ï¼Œå¯¼è‡´æ•°æ®è¢«åŒ…è£…äº†ä¸¤æ¬¡ã€‚

**å»ºè®®**ï¼šç»Ÿä¸€åç«¯APIçš„å“åº”æ ¼å¼ï¼Œé¿å…åµŒå¥—ã€‚

## æ€»ç»“

âœ… **é—®é¢˜å·²ä¿®å¤**
- å‰ç«¯å…¼å®¹åµŒå¥—å’Œç®€å•ä¸¤ç§å“åº”æ ¼å¼
- æ•°æ®æ­£ç¡®è§£æå’Œæ˜¾ç¤º
- æ°´æ³¢å›¾æ­£å¸¸å·¥ä½œ
- è¯¦æƒ…å¼¹çª—æ­£å¸¸æ˜¾ç¤º

---

**ä¿®å¤å®Œæˆæ—¶é—´**ï¼š2025-01-17  
**æ–‡ä»¶**ï¼š`VisitorPlanDashboard.vue`  
**ä¿®æ”¹è¡Œæ•°**ï¼šçº¦20è¡Œ

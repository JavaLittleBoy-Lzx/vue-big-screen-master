# ä»Šæ—¥è®¡åˆ’çœ‹æ¿404é”™è¯¯ä¿®å¤

## é”™è¯¯ä¿¡æ¯

```
GET http://localhost:8675/parking/visitor/plan-dashboard/statistics 404 (Not Found)
âŒ [ä»Šæ—¥è®¡åˆ’çœ‹æ¿] åŠ è½½ç»Ÿè®¡æ•°æ®å¤±è´¥: AxiosError
```

## é—®é¢˜åŸå› 

åç«¯Controller (`VisitorPlanDashboardController.java`) å·²ç»åˆ›å»ºï¼Œä½†åç«¯æœåŠ¡**æ²¡æœ‰é‡å¯**ï¼Œå¯¼è‡´æ–°çš„APIæ¥å£æ²¡æœ‰è¢«åŠ è½½ã€‚

## è§£å†³æ–¹æ¡ˆ

### æ–¹æ¡ˆ1ï¼šé‡å¯åç«¯æœåŠ¡ï¼ˆæ¨èï¼‰

#### IntelliJ IDEAä¸­

1. åœæ­¢å½“å‰è¿è¡Œçš„åº”ç”¨ï¼ˆç‚¹å‡»çº¢è‰²åœæ­¢æŒ‰é’®ï¼‰
2. é‡æ–°è¿è¡Œ `ParkingManageApplication` ä¸»ç±»
3. ç­‰å¾…Spring Bootå¯åŠ¨å®Œæˆ

#### Mavenå‘½ä»¤è¡Œ

```bash
# åœæ­¢å½“å‰æœåŠ¡ï¼ˆCtrl+Cï¼‰
cd d:\nefu-edu-datav\boot-new-20251112

# æ¸…ç†å¹¶é‡æ–°ç¼–è¯‘
mvn clean compile

# å¯åŠ¨æœåŠ¡
mvn spring-boot:run
```

### æ–¹æ¡ˆ2ï¼šä½¿ç”¨çƒ­éƒ¨ç½²ï¼ˆå¯é€‰ï¼‰

å¦‚æœç»å¸¸ä¿®æ”¹ä»£ç ï¼Œå¯ä»¥é…ç½®Spring Boot DevToolså®ç°çƒ­éƒ¨ç½²ã€‚

**æ·»åŠ ä¾èµ–**ï¼ˆ`pom.xml`ï¼‰ï¼š
```xml
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-devtools</artifactId>
    <scope>runtime</scope>
    <optional>true</optional>
</dependency>
```

**é…ç½®**ï¼ˆ`application.yml`ï¼‰ï¼š
```yaml
spring:
  devtools:
    restart:
      enabled: true
```

## éªŒè¯æ­¥éª¤

### æ­¥éª¤1ï¼šæ£€æŸ¥åç«¯æœåŠ¡æ—¥å¿—

å¯åŠ¨åç«¯æœåŠ¡åï¼ŒæŸ¥çœ‹æ§åˆ¶å°æ—¥å¿—ï¼Œåº”è¯¥èƒ½çœ‹åˆ°ï¼š

```
Mapped "{[/parking/visitor/plan-dashboard/statistics],methods=[GET]}" onto ...
Mapped "{[/parking/visitor/plan-dashboard/detail-list],methods=[GET]}" onto ...
```

### æ­¥éª¤2ï¼šæµ‹è¯•APIæ¥å£

**æ–¹æ³•1ï¼šæµè§ˆå™¨ç›´æ¥è®¿é—®**
```
http://localhost:8675/parking/visitor/plan-dashboard/statistics
```

**é¢„æœŸå“åº”**ï¼š
```json
{
  "code": "0",
  "msg": "æˆåŠŸ",
  "data": {
    "visitorStats": {
      "total": 0,
      "completed": 0,
      "pending": 0,
      "percentage": "0.0"
    },
    "vehicleStats": {
      "expected": 0,
      "arrived": 0,
      "current": 0
    },
    "dataSource": "DATABASE",
    "updateTime": "2025-01-17T17:45:00"
  }
}
```

**æ–¹æ³•2ï¼šä½¿ç”¨Postman**

- URL: `http://localhost:8675/parking/visitor/plan-dashboard/statistics`
- Method: GET
- Headers: æ— éœ€è®¾ç½®

**æ–¹æ³•3ï¼šä½¿ç”¨curl**

```bash
curl http://localhost:8675/parking/visitor/plan-dashboard/statistics
```

### æ­¥éª¤3ï¼šåˆ·æ–°å‰ç«¯é¡µé¢

1. æŒ‰ `Ctrl + F5` å¼ºåˆ¶åˆ·æ–°æµè§ˆå™¨é¡µé¢
2. æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°ï¼ˆF12ï¼‰
3. æŸ¥çœ‹æ—¥å¿—è¾“å‡º

**æˆåŠŸæ—¥å¿—ç¤ºä¾‹**ï¼š
```
ğŸ“Š [ä»Šæ—¥è®¡åˆ’çœ‹æ¿] å¼€å§‹åŠ è½½ç»Ÿè®¡æ•°æ®...
ğŸ“¡ [ä»Šæ—¥è®¡åˆ’çœ‹æ¿] APIå“åº”: {code: "0", ...}
âœ… [ä»Šæ—¥è®¡åˆ’çœ‹æ¿] æ•°æ®åŠ è½½æˆåŠŸ {è®¿å®¢: "0/0", è½¦è¾†: "0/0"}
```

### æ­¥éª¤4ï¼šéªŒè¯æ°´æ³¢å›¾

- å·¦ä¾§ï¼š"è®¡åˆ’è®¿å®¢" æ°´æ³¢å›¾åº”è¯¥æ˜¾ç¤ºæ•°å­—
- å³ä¾§ï¼š"é¢„è®¡è½¦è¾†" æ°´æ³¢å›¾åº”è¯¥æ˜¾ç¤ºæ•°å­—
- å¦‚æœæ•°æ®åº“ä¸­æœ‰é¢„çº¦è®°å½•ï¼Œæ°´æ³¢å›¾åº”è¯¥æœ‰å¡«å……

## å¸¸è§é—®é¢˜

### Q1ï¼šé‡å¯åè¿˜æ˜¯404æ€ä¹ˆåŠï¼Ÿ

**æ£€æŸ¥æ¸…å•**ï¼š

1. **ç«¯å£æ˜¯å¦æ­£ç¡®**ï¼š
   ```bash
   # Windows
   netstat -ano | findstr "8675"
   
   # åº”è¯¥çœ‹åˆ°æœ‰è¿›ç¨‹ç›‘å¬8675ç«¯å£
   ```

2. **Controllerç±»æ˜¯å¦åœ¨æ­£ç¡®ä½ç½®**ï¼š
   ```
   d:\nefu-edu-datav\boot-new-20251112\src\main\java\com\parkingmanage\controller\VisitorPlanDashboardController.java
   ```

3. **åŒ…åæ˜¯å¦æ­£ç¡®**ï¼š
   ```java
   package com.parkingmanage.controller;
   ```

4. **æ³¨è§£æ˜¯å¦æ­£ç¡®**ï¼š
   ```java
   @RestController
   @RequestMapping("/parking/visitor/plan-dashboard")
   ```

### Q2ï¼šæ•°æ®éƒ½æ˜¯0æ€ä¹ˆåŠï¼Ÿ

è¿™æ˜¯æ­£å¸¸çš„ï¼å¦‚æœæ•°æ®åº“ä¸­æ²¡æœ‰ç¬¦åˆæ¡ä»¶çš„é¢„çº¦è®°å½•ï¼Œç»Ÿè®¡æ•°æ®å°±æ˜¯0ã€‚

**æ’å…¥æµ‹è¯•æ•°æ®**ï¼š

```sql
INSERT INTO visitor_reservation_sync (
  reservation_id, visitor_name, visitor_phone, car_number,
  start_time, end_time, pass_name, pass_dep,
  person_visit_status, car_visit_status, deleted
) VALUES
('TEST001', 'å¼ ä¸‰', '13800138001', 'äº¬A12345',
 DATE_ADD(NOW(), INTERVAL -1 HOUR), 
 DATE_ADD(NOW(), INTERVAL 2 HOUR),
 'æå››', 'æŠ€æœ¯éƒ¨', 
 'äººå·²è¿›åœº', 'å·²è¿›åœº', 0);
```

æ’å…¥æ•°æ®åï¼Œç­‰å¾…30ç§’æˆ–åˆ·æ–°é¡µé¢ï¼Œåº”è¯¥èƒ½çœ‹åˆ°æ•°æ®æ›´æ–°ã€‚

### Q3ï¼šCORSè·¨åŸŸé”™è¯¯æ€ä¹ˆåŠï¼Ÿ

å¦‚æœçœ‹åˆ°CORSé”™è¯¯ï¼Œéœ€è¦é…ç½®åç«¯å…è®¸è·¨åŸŸè¯·æ±‚ã€‚

**æ£€æŸ¥æ˜¯å¦æœ‰CORSé…ç½®**ï¼š

```java
@Configuration
public class CorsConfig {
    @Bean
    public CorsFilter corsFilter() {
        CorsConfiguration config = new CorsConfiguration();
        config.addAllowedOrigin("http://localhost:8080");
        config.addAllowedOrigin("http://127.0.0.1:8080");
        config.setAllowCredentials(true);
        config.addAllowedMethod("*");
        config.addAllowedHeader("*");
        
        UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();
        source.registerCorsConfiguration("/**", config);
        
        return new CorsFilter(source);
    }
}
```

## å®Œæ•´æµ‹è¯•æµç¨‹

### 1. åœæ­¢å‰ç«¯å’Œåç«¯æœåŠ¡

### 2. é‡å¯åç«¯æœåŠ¡

```bash
cd d:\nefu-edu-datav\boot-new-20251112
mvn clean spring-boot:run
```

ç­‰å¾…çœ‹åˆ°ï¼š
```
Tomcat started on port(s): 8675 (http)
Started ParkingManageApplication in X.XXX seconds
```

### 3. éªŒè¯åç«¯API

æµè§ˆå™¨è®¿é—®ï¼š`http://localhost:8675/parking/visitor/plan-dashboard/statistics`

åº”è¯¥çœ‹åˆ°JSONå“åº”ï¼ˆå³ä½¿æ•°æ®ä¸º0ä¹Ÿæ˜¯æˆåŠŸçš„ï¼‰ã€‚

### 4. å¯åŠ¨å‰ç«¯æœåŠ¡

```bash
cd d:\nefu-edu-datav\vue-big-screen-master
npm run serve
```

### 5. è®¿é—®å‰ç«¯é¡µé¢

æµè§ˆå™¨è®¿é—®ï¼š`http://localhost:8080`

æ‰¾åˆ°"ä»Šæ—¥è®¡åˆ’çœ‹æ¿"ç»„ä»¶ï¼Œåº”è¯¥èƒ½çœ‹åˆ°æ°´æ³¢å›¾æ˜¾ç¤ºã€‚

### 6. æ£€æŸ¥æ§åˆ¶å°æ—¥å¿—

æŒ‰F12æ‰“å¼€æ§åˆ¶å°ï¼Œåº”è¯¥çœ‹åˆ°æˆåŠŸæ—¥å¿—ï¼Œæ²¡æœ‰404é”™è¯¯ã€‚

## APIæ¥å£æ–‡æ¡£

### 1. è·å–ç»Ÿè®¡æ•°æ®

**æ¥å£**: `GET /parking/visitor/plan-dashboard/statistics`

**è¯´æ˜**: è·å–ä»Šæ—¥è®¡åˆ’è®¿å®¢å’Œè½¦è¾†çš„ç»Ÿè®¡æ•°æ®

**å‚æ•°**: æ— 

**å“åº”**: 
```json
{
  "code": "0",
  "msg": "æˆåŠŸ",
  "data": {
    "visitorStats": {
      "total": 45,          // è®¡åˆ’è®¿å®¢æ€»æ•°
      "completed": 32,      // å·²æ¥è®¿äººæ•°
      "pending": 13,        // å¾…æ¥è®¿äººæ•°
      "percentage": "71.1"  // æ¥è®¿ç‡
    },
    "vehicleStats": {
      "expected": 28,   // é¢„è®¡è½¦è¾†æ•°
      "arrived": 20,    // å·²åˆ°è½¦è¾†æ•°
      "current": 8      // å¾…åˆ°è½¦è¾†æ•°
    },
    "dataSource": "DATABASE",
    "updateTime": "2025-01-17T17:30:00"
  }
}
```

### 2. è·å–è¯¦ç»†åˆ—è¡¨

**æ¥å£**: `GET /parking/visitor/plan-dashboard/detail-list`

**è¯´æ˜**: è·å–è®¿å®¢æˆ–è½¦è¾†çš„è¯¦ç»†é¢„çº¦åˆ—è¡¨

**å‚æ•°**:
- `type` (å¯é€‰): `visitor`-è®¿å®¢åˆ—è¡¨, `vehicle`-è½¦è¾†åˆ—è¡¨, é»˜è®¤`visitor`

**ç¤ºä¾‹**: 
```
GET /parking/visitor/plan-dashboard/detail-list?type=visitor
GET /parking/visitor/plan-dashboard/detail-list?type=vehicle
```

**å“åº”**: 
```json
{
  "code": "0",
  "msg": "æˆåŠŸ",
  "data": {
    "list": [
      {
        "id": 1,
        "visitorName": "å¼ ä¸‰",
        "visitorPhone": "13800138000",
        "carNumber": "äº¬A12345",
        "startTime": "2025-01-17T08:00:00",
        "endTime": "2025-01-17T18:00:00",
        "passName": "æå››",
        "passDep": "æŠ€æœ¯éƒ¨",
        "personVisitStatus": "äººå·²è¿›åœº",
        "carVisitStatus": "å·²è¿›åœº"
      }
    ],
    "total": 1,
    "type": "visitor"
  }
}
```

## æ€»ç»“

### âœ… é—®é¢˜åŸå› 
- æ–°åˆ›å»ºçš„Controlleræ²¡æœ‰è¢«åŠ è½½
- éœ€è¦é‡å¯åç«¯æœåŠ¡

### âœ… è§£å†³æ–¹æ¡ˆ
- é‡å¯Spring Bootåº”ç”¨
- éªŒè¯APIæ¥å£å¯è®¿é—®
- åˆ·æ–°å‰ç«¯é¡µé¢

### âœ… éªŒè¯æ–¹æ³•
- æµè§ˆå™¨è®¿é—®APIåœ°å€
- æŸ¥çœ‹åç«¯å¯åŠ¨æ—¥å¿—
- æ£€æŸ¥å‰ç«¯æ§åˆ¶å°æ—¥å¿—

---

**ä¿®å¤å®Œæˆæ—¶é—´**ï¼š2025-01-17  
**é—®é¢˜ç±»å‹**ï¼šéƒ¨ç½²é—®é¢˜ï¼ˆéä»£ç BUGï¼‰  
**è§£å†³æ—¶é—´**ï¼š< 1åˆ†é’Ÿï¼ˆé‡å¯æœåŠ¡ï¼‰
